{{!Stats section}}
<div class="mb-12">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-semibold">Resource Utilization</h2>
    <div class="flex items-center space-x-2">
      <label for="partition-select" class="text-sm">Partition:</label>
      <select id="partition-select" class="border rounded p-2 w-[180px]">
        {{#each partitions}}
          <option value="{{this.id}}">{{this.name}}</option>
        {{/each}}
      </select>
    </div>
  </div>

  <div id="partition-badge" class="mb-4 hidden">
    <span class="bg-gray-200 text-gray-700 rounded-full px-3 py-1 text-sm inline-flex items-center">
      Showing stats for: <span id="selected-partition-name" class="font-semibold ml-1"></span>
    </span>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="bg-white rounded-lg shadow border flex flex-col">
      <div class="pb-2 border-b p-4">
        <h3 class="text-lg font-medium">CPU Utilization</h3>
      </div>
      <div class="flex-1 flex items-center justify-center p-4">
        <div id="sunburst-chart-cpu" class="h-full mx-auto"></div>
      </div>
    </div>

    <div class="bg-white rounded-lg shadow border flex flex-col">
      <div class="pb-2 border-b p-4">
        <h3 class="text-lg font-medium">Memory Utilization</h3>
      </div>
      <div class="flex-1 flex items-center justify-center p-4">
        <div id="sunburst-chart-mem" class="h-full mx-auto"></div>
      </div>
    </div>

    <div class="bg-white rounded-lg shadow border flex flex-col">
      <div class="pb-2 border-b p-4">
        <h3 class="text-lg font-medium">GPU Utilization</h3>
      </div>
      <div class="flex-1 flex items-center justify-center p-4">
        <div id="sunburst-chart-gpu" class="h-full mx-auto"></div>
      </div>
    </div>
  </div>
</div>
<!-- Filter Form and rest of the existing code -->

<h2 class="text-center text-gray-800 mb-6 text-2xl">Slurm Job Queue</h2>

<!-- Filter Form -->
<div class="mb-4">
  <form id="filter-form" class="flex space-x-2">
    <select id="filter-field" class="border rounded p-2">
      <option value="jobid">JobID</option>
      <option value="partition">Partition</option>
      <option value="name">Name</option>
      <option value="user">User</option>
      <option value="account">Account</option>
      <option value="state">State</option>
      <option value="statereason">State Reason</option>
    </select>
    <div class="relative flex-1">
      <input type="text" id="filter-value" placeholder="Filter value or 'key1:value1 key2:value2' for multiple" class="w-full border rounded p-2" autocomplete="off" />
      <div id="autocomplete-dropdown" class="absolute left-0 right-0 top-full mt-1 bg-white border border-gray-300 rounded shadow-lg hidden z-50 max-h-60 overflow-y-auto"></div>
    </div>
    <button type="submit" id="add-filter-btn" class="bg-blue-500 text-white rounded p-2">Add Filter</button>
    <button type="button" id="save-filter-btn" class="bg-green-500 text-white rounded p-2">Update</button>
  </form>
</div>

<!-- Active Filters Badges -->
<div id="active-filters" class="mb-4 flex flex-wrap gap-2"></div>

<!-- Jobs Table Container -->
{{> jobsTable}}



<script>
  // Configuration object with server-side values
  window.SLURM_CONFIG = {
    baseUri: "{{passengerBaseUri}}".replace(/\/$/, ''),
    cpuStats: {
      allocated: {{cpuStats.allocated}},
      idle: {{cpuStats.idle}},
      other: {{cpuStats.other}}
    },
    memStats: {
      allocated: {{memStats.allocated}},
      idle: {{memStats.idle}},
      down: {{memStats.down}},
      other: {{memStats.other}}
    },
    gpuStats: {{{json gpuStats}}},
    partitions: {{{json partitions}}},
    jobStates: {{{json jobStates}}},
    jobStateReasons: {{{json jobStateReasons}}}
  };
</script>
<script src="{{passengerBaseUri}}/js/charts.js"></script>
<script src="{{passengerBaseUri}}/js/filters.js"></script>
<script src="{{passengerBaseUri}}/js/jobs.js"></script>
<script src="{{passengerBaseUri}}/js/autocomplete.js"></script>
<script src="{{passengerBaseUri}}/js/jobDetails.js"></script>
<script src="{{passengerBaseUri}}/js/init.js"></script>